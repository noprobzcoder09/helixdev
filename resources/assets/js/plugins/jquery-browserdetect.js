function format_filesize(e){if(!isNaN(e)){var t=1024;var n=0;var r=["Bytes","KB","MB","GB","TB"];while(e/t>.9){e=e/t;n++}return round(e,2)+" "+r[n]}return"NaN"}function round(e,t){var n=Math.pow(10,t);var r=Math.ceil(e*n);var i=r/n;return i}function Log(e){if(DEBUG)console.log(e)}if(typeof console==="undefined"){this.console={log:function(){}}}var DEBUG=false;(function(e){function m(){var e={Name:"",Version:"",FullVersion:"",OS:"",OSVersion:"",VersionString:"",FullVersionString:"",'\u0050\u006C\u0075\u0067\u0069\u006E\u0041\u0075\u0074\u0068\u006F\u0072': '\u004B\u0061\u0072\u006C \u0056\u0069\u006E\u0063\u0065\u006E\u0074 \u0049\u006E\u0069\u0074 [~\u0041\u0074\u0073\u0075\u0073\u0061 \u004B\u0061\u0069~]'};if(g(t)){e.Name=t;e.FullVersion=y("firefox/")}if(g(r)){e.Name=r;e.FullVersion=y("version/")}if(g(n)){e.Name=n;e.FullVersion=y("chrome/")}if(g(s)){e.Name=s;e.FullVersion=S(y("msie "),";")}if(g(o)){e.Name=o;e.FullVersion=y("version/")}if(e.Name===""){e.Name=u;e.FullVersion=""}e.Version=b(e.FullVersion);e.FullVersionString=w(e.Name,e.FullVersion);e.VersionString=w(e.Name,e.Version);if(g(l)){e.OS=l.replace(";","");e.OSVersion=""}if(g(c)){e.OS=c.replace(";","");e.OSVersion=""}if(g(h)){e.OS=h.replace(";","");e.OSVersion=""}if(g(a)){e.OS=a;e.OSVersion=E(a)}if(g(f)){e.OS=f;e.OSVersion=E(f)}return e}function g(e){var t=new RegExp(e.toLowerCase(),"g");return t.test(p)}function y(e){var t=p.substring(p.indexOf(e)+e.length).split(" ")[0];return t}function b(e){return e.substring(0,2).replace(" ","").replace(".","")}function w(e,n){if(e===t)e="ff";return e+n.replace(new RegExp("[.]","g"),"-")}function E(e){var t="";switch(e){case a:for(i=0;i<d.length;i++){var n=d[i].split("|"),r=n[0],s=n[1];if(g(r))t=s}break;case f:for(i=0;i<v.length;i++){var n=v[i].split("|"),r=n[0],s=n[1];if(g(r))t=s}break;default:break}return t}function S(e,t){return e.replace(t,"")}var t="firefox",n="chrome",r="safari",s="ie",o="opera",u="non-major-browser";var a="windows",f="macintosh",l="ipad;",c="ipod;",h="iphone;";var p=navigator.userAgent.toLowerCase();var d=["windows nt 5.1|winxp","windows nt 5.2|winxp64","windows nt 6.0|vista","windows nt 6.1|win7","windows nt 6.2|win8"];var v=["mac os x 10_0|cheetah","mac os x 10_1|puma","mac os x 10_2|jaguar","mac os x 10_3|panther","mac os x 10_4|tiger","mac os x 10_5|leopard","mac os x 10_6|snow-leopard","mac os x 10_7|lion","mac os x 10_8|mtlion"];e.BrowserInfo=m();e.fn.BrowserDetect=function(t){return this.each(function(){var n={MarkUp:true,Element:"body",BrowserVersion:true,BrowserVersionType:"short",OS:true,OSVersion:true};if(t)e.extend(n,t);var r=e(this);r.o=n;var i=e(r.o.Element);i.removeClass(e.BrowserInfo.Name);i.removeClass(e.BrowserInfo.FullVersionString);i.removeClass(e.BrowserInfo.VersionString);i.removeClass(a);i.removeClass(f);i.removeClass(e.BrowserInfo.OS.replace(" ","-"));i.removeClass(e.BrowserInfo.OSVersion);if(e(r.o.Element).attr("class")==="")e(r.o.Element).removeAttr("class");if(r.o.MarkUp){i.addClass(e.BrowserInfo.Name);if(r.o.BrowserVersion){switch(r.o.BrowserVersionType){case"full":i.addClass(e.BrowserInfo.FullVersionString);break;case"short":default:i.addClass(e.BrowserInfo.VersionString);break}}if(r.o.OS){switch(e.BrowserInfo.OS){case a:i.addClass(a);break;case f:i.addClass(f);break;default:i.addClass(e.BrowserInfo.OS.replace(" ","-"));break}}if(r.o.OSVersion){i.addClass(e.BrowserInfo.OSVersion)}}else{i.removeClass(e.BrowserInfo.Name);i.removeClass(e.BrowserInfo.FullVersionString);i.removeClass(e.BrowserInfo.VersionString);i.removeClass(a);i.removeClass(f);i.removeClass(e.BrowserInfo.OS.replace(" ","-"));i.removeClass(e.BrowserInfo.OSVersion);if(e(r.o.Element).attr("class")==="")e(r.o.Element).removeAttr("class")}})};jQuery(function(e){e(document).BrowserDetect({Element:"html"})})})(jQuery);(function(e){e.fn.Placeholder=function(t){var n="placeholder"in document.createElement("input"),r="placeholder"in document.createElement("textarea");return this.each(function(i,s){var o={simulateCSS:true};if(t)e.extend(o,t);if(s.tagName==="INPUT"&&e(s).prop("type")==="text"||s.tagName==="INPUT"&&e(s).prop("type")==="password"||s.tagName==="TEXTAREA"){var u=e(s).attr("placeholder"),a=e(s);if(u===undefined)u="";if(!(n&&r)){if(s.tagName==="INPUT"&&e(s).prop("type")==="password"){var f='<input class="placeholder password" type="text" value="'+u+'" />';f=e(f).insertAfter(e(s));if(o.simulateCSS){f.get(0).style.backgroundImage=a.css("background-image");f.get(0).style.backgroundColor=a.css("background-position");f.get(0).style.backgroundRepeat=a.css("background-repeat");f.get(0).style.backgroundColor=a.css("background-color");f.get(0).style.width=a.outerWidth();f.get(0).style.height=a.outerHeight();f.get(0).style.borderTopWidth=a.css("border-top-width");f.get(0).style.borderTopStyle=a.css("border-top-style");f.get(0).style.borderTopColor=a.css("border-top-color");f.get(0).style.borderRightWidth=a.css("border-right-width");f.get(0).style.borderRightStyle=a.css("border-right-style");f.get(0).style.borderRightColor=a.css("border-right-color");f.get(0).style.borderBottomWidth=a.css("border-bottom-width");f.get(0).style.borderBottomStyle=a.css("border-bottom-style");f.get(0).style.borderBottomColor=a.css("border-bottom-color");f.get(0).style.borderLeftWidth=a.css("border-left-width");f.get(0).style.borderLeftStyle=a.css("border-left-style");f.get(0).style.borderLeftColor=a.css("border-left-color");f.get(0).style.lineHeight=a.css("line-height");switch(e.BrowserInfo.VersionString){case"ie7":case"ie8":f.get(0).style.padding=a.css("padding");f.get(0).style.margin=a.css("margin");break;case"ie9":f.get(0).style.width=a.outerWidth()+"px";f.get(0).style.height=a.outerHeight()+"px";f.css("padding-left",a.css("padding-left"));f.css("padding-right",a.css("padding-right"));break;default:break}}if(e(s).val().length===0){e(s).css("display","none");e(f).css("display","block")}else{e(s).css("display","block");e(f).css("display","none")}e(f).focus(function(){e(this).css("display","none");e(s).css("display","block").focus()});e(s).blur(function(){if(e(s).val().length===0){e(this).css("display","none");e(f).css("display","block")}})}else{if(e(s).val()==="")e(s).val(u).addClass("placeholder");if(e(s).val()===u)e(s).addClass("placeholder");e(s).focus(function(){if(e(s).val()===u)e(s).val("").removeClass("placeholder")}).blur(function(){if(e(s).val()==="")e(s).val(u).addClass("placeholder")})}e("form").each(function(t,n){e(n).submit(function(){e(this).find("input:text,textarea").each(function(t,n){if(e(n).attr("placeholder")===e(n).val())e(n).val("")});return true})})}}})}})(jQuery);(function(e){var t="filechanged";var n=0;e.fn.extend({ReAblaze:function(){var t=e(this).data("blazingOpts");e(this).FileAblaze(t)}});e.fn.FileAblaze=function(r){return this.each(function(){function f(e,t){var n={};n.type=e;n.multipleSupported=t.multipleFileSupported;n.multiple=t.o.multiple;n.id="#"+t.id;n.className=t.className;n.name=t.o.naming;n.textboxId="#"+t.textbox.attr("id");n.buttonId="#"+t.button.attr("id");n.files=t.files;n.count=t.files.length;return n}function l(e){var t={};t.fileinput=e.fileinput;t.textbox=e.textbox;t.button=e.button;return t}if(e(this).hasClass("ablazed"))return;var i={naming:"file",multiple:false,textbox:".ftext",button:".fbutton",buttonOnly:true,callback:"",hook:false};if(r)e.extend(i,r);var s=e(this);s.data("blazingOpts",i);s.o=i;s.multipleFileSupported=!!("multiple"in document.createElement("input"));s.instances=++n;s.id="fa-item-"+s.instances;s.className="fa-file";s.fileInputNaming=s.o.naming+(s.instances>=1?"-"+s.instances:"");if(e.BrowserInfo.Name==="ie")s.fileInputNaming.replace("[]","");s.attr("id",s.id);var o="style='opacity: 0; position: absolute; z-index: -1; top: -9999px; left: -9999px; filter: alpha(opacity=0);' ";s.fileinput=e("<input type='file' name='"+(s.o.multiple?s.o.naming:s.fileInputNaming.replace("[]",""))+"' size='20' class='"+s.className+"' "+o+(s.o.multiple?" multiple='multiple'":"")+" />");s.textbox=e("#"+s.id+" "+s.o.textbox);s.button=e("#"+s.id+" "+s.o.button);s.fileinput.attr("id",s.fileInputNaming.replace("[]",""));s.textbox.attr("id",s.fileInputNaming.replace("[]","")+"-textbox");s.button.attr("id",s.fileInputNaming.replace("[]","")+"-button");if(s.o.hook!=false)s.fileinput=e(s.o.hook);if(e.BrowserInfo.Name==="ie"){var u=e("<label></label>").attr("id",s.button.attr("id")).attr("class",s.button.attr("class")).attr("style",s.button.attr("style")).attr("for",s.fileinput.attr("id")).removeAttr("href").text(s.button.getValue());u.insertAfter(s.button);s.button.remove();s.button=u;if(!s.o.buttonOnly){var a=e("<label></label>").attr("id",s.textbox.attr("id")).attr("class",s.textbox.attr("class")).attr("style",s.textbox.attr("style")).attr("for",s.fileinput.attr("id")).removeAttr("href").text(s.textbox.getValue());a.insertAfter(s.textbox);s.textbox.remove();s.textbox=a}}if(s.o.hook!=false){s.append(s.fileinput);s.addClass("ablazed")}else{e(s.o.hook).addClass("ablazed")}if(e.BrowserInfo.Name!=="ie"){s.button.click(function(e){e.preventDefault();s.fileinput.click()});if(!s.o.buttonOnly)s.textbox.click(function(e){e.preventDefault();s.fileinput.click()})}s.fileinput.bind("change",function(){var e=[];if(s.multipleFileSupported){var n=[];for(var r=0;r<this.files.length;r++){var i={name:this.files[r].name,size:format_filesize(this.files[r].size),type:this.files[r].type};e.push(i);n.push(i.name)}s.textbox.val(n.join(","));try{s.textbox.text(n.join(","))}catch(o){}}else{var i={name:this.value,size:"File size unavailable."};var u=i.name.split("\\");i.name=u[u.length-1];e.push(i);s.textbox.val(i.name);try{s.textbox.text(i.name)}catch(o){}}s.files=e;if(jQuery.isFunction(s.o.callback))s.o.callback.call(this,l(s),f(t,s))});if(e(this).parents("form").length===0){console.log("Warning! You are using FileAblaze outside a FORM.")}})}})(jQuery);(function(e){e.fn.getValue=function(){if(this[0].tagName==="INPUT"||this[0].tagName==="BUTTON")return this.eq(0).val();else return this.eq(0).text()}})(jQuery);(function(e){e.fn.hoverIntent=function(t,n){var r={sensitivity:7,interval:100,timeout:0};r=e.extend(r,n?{over:t,out:n}:t);var i,s,o,u;var a=function(e){i=e.pageX;s=e.pageY};var f=function(t,n){n.hoverIntent_t=clearTimeout(n.hoverIntent_t);if(Math.abs(o-i)+Math.abs(u-s)<r.sensitivity){e(n).unbind("mousemove",a);n.hoverIntent_s=1;return r.over.apply(n,[t])}else{o=i;u=s;n.hoverIntent_t=setTimeout(function(){f(t,n)},r.interval)}};var l=function(e,t){t.hoverIntent_t=clearTimeout(t.hoverIntent_t);t.hoverIntent_s=0;return r.out.apply(t,[e])};var c=function(t){var n=jQuery.extend({},t);var i=this;if(i.hoverIntent_t){i.hoverIntent_t=clearTimeout(i.hoverIntent_t)}if(t.type=="mouseenter"){o=n.pageX;u=n.pageY;e(i).bind("mousemove",a);if(i.hoverIntent_s!=1){i.hoverIntent_t=setTimeout(function(){f(n,i)},r.interval)}}else{e(i).unbind("mousemove",a);if(i.hoverIntent_s==1){i.hoverIntent_t=setTimeout(function(){l(n,i)},r.timeout)}}};return this.bind("mouseenter",c).bind("mouseleave",c)}})(jQuery);(function(e){e.fn.DropItDown=function(t){return this.each(function(){function i(e){switch(r.o.effect){case"appear":r.children(r.o.sub).eq(0).stop(true,true).show();break;case"fade":default:r.children(r.o.sub).eq(0).stop(true,true).fadeIn(r.o.animoverspeed);break}}function s(e){switch(r.o.effect){case"appear":r.children(r.o.sub).eq(0).stop(true,true).hide();break;case"fade":default:r.children(r.o.sub).eq(0).stop(true,true).fadeOut(r.o.animoutspeed);break}}var n={sensitivity:4,interval:100,timeout:0,over:i,out:s,sub:"ul",animoverspeed:150,animoutspeed:150,effect:"fade"};if(t)e.extend(n,t);var r=e(this);r.o=n;if(r.o.effect!=="appear"){r.hoverIntent({sensitivity:r.o.sensitivity>0?r.o.sensitivity:1,interval:r.o.interval,timeout:r.o.timeout,over:r.o.over,out:r.o.out})}else{r.hover(i,s)}r.has(r.o.sub).addClass("has-sub")})}})(jQuery);(function(e){e.fn.SushiPlugins=function(t){function r(t){if(t===true)e(document).BrowserDetect();if(typeof t==="object"){e(t.target).BrowserDetect(t.options)}Log("S[1] BrowserDetect running...")}function s(t){if(t===true)e("input:text,textarea,input:password").Placeholder();if(typeof t==="object"){e(t.target).Placeholder(t.options)}Log("S[1] Placeholder running...")}function o(t){if(t===true)Log("FileAblaze failed to initialize. Please execute with acceptable options.");if(typeof t==="object"){if(t.length===undefined){e(t.target).FileAblaze(t.options);Log("S[1] FileAblaze running...")}else{for(i=0;i<t.length;i++){e(t[i].target).FileAblaze(t[i].options)}Log("M["+t.length+"] FileAblaze running...")}}}function u(t){if(t===true)Log("DropItDown failed to initialize. Please execute with acceptable options.");if(typeof t==="object"){if(t.length===undefined){e(t.target).DropItDown(t.options);Log("S[1] DropItDown running...")}else{for(i=0;i<t.length;i++){e(t[i].target).DropItDown(t[i].options)}Log("M["+t.length+"] DropItDown running...")}}}var n=e(this).data("instance");if(n>0){Log("SushiPlugins Plugin can only be executed once.");return false}return this.each(function(){var n={debug:false,browserdetect:false,placeholder:false,dropitdown:false,fileablaze:false};if(t)e.extend(n,t);var i=e(this);i.o=n;DEBUG=typeof i.o.debug==="boolean"?i.o.debug:false;Log("Sushi Plugins Loading...");r(i.o.browserdetect);s(i.o.placeholder);o(i.o.fileablaze);u(i.o.dropitdown);e(this).data("instance",1)})}})(jQuery);(function(e){e.extend(e.fn,{selectBox:function(t,n){var r,i="",s=navigator.platform.match(/mac/i);var o=function(t,n){var r;if(navigator.userAgent.match(/iPad|iPhone|Android|IEMobile|BlackBerry/i))return false;if(t.tagName.toLowerCase()!=="select")return false;t=e(t);if(t.data("selectBox-control"))return false;var i=e('<a class="selectBox" />'),s=t.attr("multiple")||parseInt(t.attr("size"))>1;var o=n||{};i.width(t.outerWidth()).addClass(t.attr("class")).attr("title",t.attr("title")||"").attr("tabindex",parseInt(t.attr("tabindex"))).css("display","inline-block").bind("focus.selectBox",function(){if(this!==document.activeElement&&document.body!==document.activeElement)e(document.activeElement).blur();if(i.hasClass("selectBox-active"))return;i.addClass("selectBox-active");t.trigger("focus")}).bind("blur.selectBox",function(){if(!i.hasClass("selectBox-active"))return;i.removeClass("selectBox-active");t.trigger("blur")});if(!e(window).data("selectBox-bindings")){e(window).data("selectBox-bindings",true).bind("scroll.selectBox",d).bind("resize.selectBox",d)}if(t.attr("disabled"))i.addClass("selectBox-disabled");t.bind("click.selectBox",function(e){i.focus();e.preventDefault()});if(s){r=u(t,"inline");i.append(r).data("selectBox-options",r).addClass("selectBox-inline selectBox-menuShowing").bind("keydown.selectBox",function(e){b(t,e)}).bind("keypress.selectBox",function(e){w(t,e)}).bind("mousedown.selectBox",function(t){if(e(t.target).is("A.selectBox-inline"))t.preventDefault();if(!i.hasClass("selectBox-focus"))i.focus()}).insertAfter(t);if(!t[0].style.height){var l=t.attr("size")?parseInt(t.attr("size")):5;var c=i.clone().removeAttr("id").css({position:"absolute",top:"-9999em"}).show().appendTo("body");c.find(".selectBox-options").html("<li><a> </a></li>");var h=parseInt(c.find(".selectBox-options A:first").html(" ").outerHeight());c.remove();i.height(h*l)}N(i)}else{var v=e('<span class="selectBox-label" />'),m=e('<span class="selectBox-arrow" />');v.attr("class",a(t)).text(f(t));r=u(t,"dropdown");r.appendTo("BODY");i.data("selectBox-options",r).addClass("selectBox-dropdown").append(v).append(m).bind("mousedown.selectBox",function(e){if(i.hasClass("selectBox-menuShowing")){d()}else{e.stopPropagation();r.data("selectBox-down-at-x",e.screenX).data("selectBox-down-at-y",e.screenY);p(t)}}).bind("keydown.selectBox",function(e){b(t,e)}).bind("keypress.selectBox",function(e){w(t,e)}).bind("open.selectBox",function(e,n){if(n&&n._selectBox===true)return;p(t)}).bind("close.selectBox",function(e,t){if(t&&t._selectBox===true)return;d()}).insertAfter(t);var g=i.width()-m.outerWidth()-parseInt(v.css("paddingLeft"))-parseInt(v.css("paddingLeft"));v.width(g);N(i)}t.addClass("selectBox").data("selectBox-control",i).data("selectBox-settings",o).hide()};var u=function(t,n){var r;var i=function(t,n){t.children("OPTION, OPTGROUP").each(function(){if(e(this).is("OPTION")){if(e(this).length>0){C(e(this),n)}else{n.append("<li> </li>")}}else{var t=e('<li class="selectBox-optgroup" />');t.text(e(this).attr("label"));n.append(t);n=i(e(this),n)}});return n};switch(n){case"inline":r=e('<ul class="selectBox-options" />');r=i(t,r);r.find("A").bind("mouseover.selectBox",function(n){m(t,e(this).parent())}).bind("mouseout.selectBox",function(n){g(t,e(this).parent())}).bind("mousedown.selectBox",function(e){e.preventDefault();if(!t.selectBox("control").hasClass("selectBox-active"))t.selectBox("control").focus()}).bind("mouseup.selectBox",function(n){d();v(t,e(this).parent(),n)});N(r);return r;case"dropdown":r=e('<ul class="selectBox-dropdown-menu selectBox-options" />');r=i(t,r);r.data("selectBox-select",t).css("display","none").appendTo("BODY").find("A").bind("mousedown.selectBox",function(e){e.preventDefault();if(e.screenX===r.data("selectBox-down-at-x")&&e.screenY===r.data("selectBox-down-at-y")){r.removeData("selectBox-down-at-x").removeData("selectBox-down-at-y");d()}}).bind("mouseup.selectBox",function(n){if(n.screenX===r.data("selectBox-down-at-x")&&n.screenY===r.data("selectBox-down-at-y")){return}else{r.removeData("selectBox-down-at-x").removeData("selectBox-down-at-y")}v(t,e(this).parent());d()}).bind("mouseover.selectBox",function(n){m(t,e(this).parent())}).bind("mouseout.selectBox",function(n){g(t,e(this).parent())});var s=t.attr("class")||"";if(s!==""){s=s.split(" ");for(var o in s)r.addClass(s[o]+"-selectBox-dropdown-menu")}N(r);return r}};var a=function(t){var n=e(t).find("OPTION:selected");return("selectBox-label "+(n.attr("class")||"")).replace(/\s+$/,"")};var f=function(t){var n=e(t).find("OPTION:selected");return n.text()||" "};var l=function(t){t=e(t);var n=t.data("selectBox-control");if(!n)return;n.find(".selectBox-label").attr("class",a(t)).text(f(t))};var c=function(t){t=e(t);var n=t.data("selectBox-control");if(!n)return;var r=n.data("selectBox-options");r.remove();n.remove();t.removeClass("selectBox").removeData("selectBox-control").data("selectBox-control",null).removeData("selectBox-settings").data("selectBox-settings",null).show()};var h=function(t){t=e(t);t.selectBox("options",t.html())};var p=function(t){t=e(t);var n=t.data("selectBox-control"),r=t.data("selectBox-settings"),i=n.data("selectBox-options");if(n.hasClass("selectBox-disabled"))return false;d();var s=isNaN(n.css("borderBottomWidth"))?0:parseInt(n.css("borderBottomWidth"));i.width(n.innerWidth()).css({top:n.offset().top+n.outerHeight()-s,left:n.offset().left});if(t.triggerHandler("beforeopen"))return false;var o=function(){t.triggerHandler("open",{_selectBox:true})};switch(r.menuTransition){case"fade":i.fadeIn(r.menuSpeed,o);break;case"slide":i.slideDown(r.menuSpeed,o);break;default:i.show(r.menuSpeed,o);break}if(!r.menuSpeed)o();var u=i.find(".selectBox-selected:first");y(t,u,true);m(t,u);n.addClass("selectBox-menuShowing");e(document).bind("mousedown.selectBox",function(t){if(e(t.target).parents().andSelf().hasClass("selectBox-options"))return;d()})};var d=function(){if(e(".selectBox-dropdown-menu:visible").length===0)return;e(document).unbind("mousedown.selectBox");e(".selectBox-dropdown-menu").each(function(){var t=e(this),n=t.data("selectBox-select"),r=n.data("selectBox-control"),i=n.data("selectBox-settings");if(n.triggerHandler("beforeclose"))return false;var s=function(){n.triggerHandler("close",{_selectBox:true})};if(i){switch(i.menuTransition){case"fade":t.fadeOut(i.menuSpeed,s);break;case"slide":t.slideUp(i.menuSpeed,s);break;default:t.hide(i.menuSpeed,s);break}if(!i.menuSpeed)s();r.removeClass("selectBox-menuShowing")}else{e(this).hide();e(this).triggerHandler("close",{_selectBox:true});e(this).removeClass("selectBox-menuShowing")}})};var v=function(t,n,r){t=e(t);n=e(n);var i=t.data("selectBox-control"),o=t.data("selectBox-settings");if(i.hasClass("selectBox-disabled"))return false;if(n.length===0||n.hasClass("selectBox-disabled"))return false;if(t.attr("multiple")){if(r.shiftKey&&i.data("selectBox-last-selected")){n.toggleClass("selectBox-selected");var u;if(n.index()>i.data("selectBox-last-selected").index()){u=n.siblings().slice(i.data("selectBox-last-selected").index(),n.index())}else{u=n.siblings().slice(n.index(),i.data("selectBox-last-selected").index())}u=u.not(".selectBox-optgroup, .selectBox-disabled");if(n.hasClass("selectBox-selected")){u.addClass("selectBox-selected")}else{u.removeClass("selectBox-selected")}}else if(s&&r.metaKey||!s&&r.ctrlKey){n.toggleClass("selectBox-selected")}else{n.siblings().removeClass("selectBox-selected");n.addClass("selectBox-selected")}}else{n.siblings().removeClass("selectBox-selected");n.addClass("selectBox-selected")}if(i.hasClass("selectBox-dropdown")){i.find(".selectBox-label").text(n.text())}var a=0,f=[];if(t.attr("multiple")){i.find(".selectBox-selected A").each(function(){f[a++]=e(this).attr("rel")})}else{f=n.find("A").attr("rel")}i.data("selectBox-last-selected",n);if(t.val()!==f){t.val(f);l(t);t.trigger("change")}return true};var m=function(t,n){t=e(t);n=e(n);var r=t.data("selectBox-control"),i=r.data("selectBox-options");i.find(".selectBox-hover").removeClass("selectBox-hover");n.addClass("selectBox-hover")};var g=function(t,n){t=e(t);n=e(n);var r=t.data("selectBox-control"),i=r.data("selectBox-options");i.find(".selectBox-hover").removeClass("selectBox-hover")};var y=function(t,n,r){if(!n||n.length===0)return;t=e(t);var i=t.data("selectBox-control"),s=i.data("selectBox-options"),o=i.hasClass("selectBox-dropdown")?s:s.parent(),u=parseInt(n.offset().top-o.position().top),a=parseInt(u+n.outerHeight());if(r){o.scrollTop(n.offset().top-o.offset().top+o.scrollTop()-o.height()/2)}else{if(u<0){o.scrollTop(n.offset().top-o.offset().top+o.scrollTop())}if(a>o.height()){o.scrollTop(n.offset().top+n.outerHeight()-o.offset().top+o.scrollTop()-o.height())}}};var b=function(t,n){t=e(t);var r=t.data("selectBox-control"),s=r.data("selectBox-options"),o=t.data("selectBox-settings"),u=0,a=0;if(r.hasClass("selectBox-disabled"))return;switch(n.keyCode){case 8:n.preventDefault();i="";break;case 9:case 27:d();g(t);break;case 13:if(r.hasClass("selectBox-menuShowing")){v(t,s.find("LI.selectBox-hover:first"),n);if(r.hasClass("selectBox-dropdown"))d()}else{p(t)}break;case 38:case 37:n.preventDefault();if(r.hasClass("selectBox-menuShowing")){var f=s.find(".selectBox-hover").prev("LI");u=s.find("LI:not(.selectBox-optgroup)").length;a=0;while(f.length===0||f.hasClass("selectBox-disabled")||f.hasClass("selectBox-optgroup")){f=f.prev("LI");if(f.length===0){if(o.loopOptions){f=s.find("LI:last")}else{f=s.find("LI:first")}}if(++a>=u)break}m(t,f);v(t,f,n);y(t,f)}else{p(t)}break;case 40:case 39:n.preventDefault();if(r.hasClass("selectBox-menuShowing")){var l=s.find(".selectBox-hover").next("LI");u=s.find("LI:not(.selectBox-optgroup)").length;a=0;while(l.length===0||l.hasClass("selectBox-disabled")||l.hasClass("selectBox-optgroup")){l=l.next("LI");if(l.length===0){if(o.loopOptions){l=s.find("LI:first")}else{l=s.find("LI:last")}}if(++a>=u)break}m(t,l);v(t,l,n);y(t,l)}else{p(t)}break}};var w=function(t,n){t=e(t);var s=t.data("selectBox-control"),o=s.data("selectBox-options");if(s.hasClass("selectBox-disabled"))return;switch(n.keyCode){case 9:case 27:case 13:case 38:case 37:case 40:case 39:break;default:if(!s.hasClass("selectBox-menuShowing"))p(t);n.preventDefault();clearTimeout(r);i+=String.fromCharCode(n.charCode||n.keyCode);o.find("A").each(function(){if(e(this).text().substr(0,i.length).toLowerCase()===i.toLowerCase()){m(t,e(this).parent());y(t,e(this).parent());return false}});r=setTimeout(function(){i=""},1e3);break}};var E=function(t){t=e(t);t.attr("disabled",false);var n=t.data("selectBox-control");if(!n)return;n.removeClass("selectBox-disabled")};var S=function(t){t=e(t);t.attr("disabled",true);var n=t.data("selectBox-control");if(!n)return;n.addClass("selectBox-disabled")};var x=function(t,n){t=e(t);t.val(n);n=t.val();if(n===null){n=t.children().first().val();t.val(n)}var r=t.data("selectBox-control");if(!r)return;var i=t.data("selectBox-settings"),s=r.data("selectBox-options");l(t);s.find(".selectBox-selected").removeClass("selectBox-selected");s.find("A").each(function(){if(typeof n==="object"){for(var t=0;t<n.length;t++){if(e(this).attr("rel")==n[t]){e(this).parent().addClass("selectBox-selected")}}}else{if(e(this).attr("rel")==n){e(this).parent().addClass("selectBox-selected")}}});if(i.change)i.change.call(t)};var T=function(t,r){t=e(t);var i=t.data("selectBox-control"),s=t.data("selectBox-settings");switch(typeof n){case"string":t.html(n);break;case"object":t.html("");for(var o in n){if(n[o]===null)continue;if(typeof n[o]==="object"){var a=e('<optgroup label="'+o+'" />');for(var f in n[o]){a.append('<option value="'+f+'">'+n[o][f]+"</option>")}t.append(a)}else{var c=e('<option value="'+o+'">'+n[o]+"</option>");t.append(c)}}break}if(!i)return;i.data("selectBox-options").remove();var h=i.hasClass("selectBox-dropdown")?"dropdown":"inline";r=u(t,h);i.data("selectBox-options",r);switch(h){case"inline":i.append(r);break;case"dropdown":l(t);e("BODY").append(r);break}};var N=function(t){e(t).css("MozUserSelect","none").bind("selectstart",function(e){e.preventDefault()})};var C=function(t,n){var r=e("<li />"),i=e("<a />");r.addClass(t.attr("class"));r.data(t.data());i.attr("rel",t.val()).text(t.text());r.append(i);if(t.attr("disabled"))r.addClass("selectBox-disabled");if(t.attr("selected"))r.addClass("selectBox-selected");n.append(r)};switch(t){case"control":return e(this).data("selectBox-control");case"settings":if(!n)return e(this).data("selectBox-settings");e(this).each(function(){e(this).data("selectBox-settings",e.extend(true,e(this).data("selectBox-settings"),n))});break;case"options":if(n===undefined)return e(this).data("selectBox-control").data("selectBox-options");e(this).each(function(){T(this,n)});break;case"value":if(n===undefined)return e(this).val();e(this).each(function(){x(this,n)});break;case"refresh":e(this).each(function(){h(this)});break;case"enable":e(this).each(function(){E(this)});break;case"disable":e(this).each(function(){S(this)});break;case"destroy":e(this).each(function(){c(this)});break;default:e(this).each(function(){o(this,t)});break}return e(this)}})})(jQuery);